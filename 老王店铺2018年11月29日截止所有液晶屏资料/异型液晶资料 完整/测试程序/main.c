#include "STC12C5A60S2.H"   //死特惨的STC8A4K32S2A12

#define uchar unsigned char
#define uint unsigned int

 uchar code LCD_DISPLAY_CHN[240]={
 /*--  文字:  隔  --*/
 /*--  Dutch801 XBd BT12;  此字体下对应的点阵为：宽x高=16x20   --*/
0x00,0x00,0x00,0x00,0x00,0x00,0x7B,0xFE,0x48,0x00,0x51,0xFC,0x51,0x04,0x61,0x04,
0x51,0xFC,0x48,0x00,0x4B,0xFE,0x4A,0x8A,0x6A,0x52,0x53,0xFE,0x42,0x22,0x42,0x22,
0x42,0x2A,0x42,0x04,0x00,0x00,0x00,0x00	,  
/*--  文字:  壁  --*/
/*--  Dutch801 XBd BT12;  此字体下对应的点阵为：宽x高=16x20   --*/
0x00,0x00,0x00,0x00,0x00,0x40,0x7C,0x20,0x45,0xFC,0x44,0x88,0x7C,0x50,0x43,0xFE,
0x7C,0x20,0xA5,0xFC,0x24,0x20,0x3D,0x20,0x01,0x00,0x3F,0xF8,0x01,0x00,0x01,0x00,
0xFF,0xFE,0x00,0x00,0x00,0x00,0x00,0x00	  ,

/*--  文字:  论  --*/
/*--  Dutch801 XBd BT12;  此字体下对应的点阵为：宽x高=16x20   --*/
0x00,0x00,0x00,0x00,0x00,0x40,0x20,0x40,0x10,0xA0,0x10,0xA0,0x01,0x10,0x02,0x08,
0xF4,0x06,0x11,0x10,0x11,0x20,0x11,0x40,0x11,0x80,0x11,0x00,0x15,0x04,0x19,0x04,
0x10,0xFC,0x00,0x00,0x00,0x00,0x00,0x00	,
										
/*--  文字:  坛  --*/
/*--  Dutch801 XBd BT12;  此字体下对应的点阵为：宽x高=16x20   --*/
0x00,0x00,0x00,0x00,0x10,0x00,0x10,0x00,0x11,0xFC,0x10,0x00,0x10,0x00,0xFC,0x00,
0x13,0xFE,0x10,0x20,0x10,0x20,0x10,0x40,0x10,0x40,0x1C,0x88,0xE1,0x04,0x43,0xFE,
0x01,0x02,0x00,0x00,0x00,0x00,0x00,0x00	,

/*--  文字:  老  --*/
/*--  Dutch801 XBd BT12;  此字体下对应的点阵为：宽x高=16x20   --*/
0x00,0x00,0x00,0x00,0x02,0x00,0x02,0x08,0x3F,0xD0,0x02,0x20,0x02,0x40,0xFF,0xFE,
0x01,0x00,0x02,0x00,0x0C,0x10,0x18,0xE0,0x2F,0x00,0x48,0x08,0x88,0x08,0x08,0x08,
0x07,0xF8,0x00,0x00,0x00,0x00,0x00,0x00	,

/*--  文字:  王  --*/
/*--  Dutch801 XBd BT12;  此字体下对应的点阵为：宽x高=16x20   --*/
0x00,0x00,0x00,0x00,0x00,0x00,0x7F,0xFC,0x01,0x00,0x01,0x00,0x01,0x00,0x01,0x00,
0x01,0x00,0x3F,0xF8,0x01,0x00,0x01,0x00,0x01,0x00,0x01,0x00,0x01,0x00,0x01,0x00,
0xFF,0xFE,0x00,0x00,0x00,0x00,0x00,0x00,


};

 uchar code LCD_DATA[1717] = {    //全屏图片：让老王赶紧上新
0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,
0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X0C,0XFC,0X00,0X00,
0X00,0X00,0XC0,0X0F,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0XC0,0X0F,0XFC,0X00,
0X00,0X00,0X00,0XC0,0X0F,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X3F,0XFC,
0XF0,0X03,0X00,0X00,0XC0,0X0F,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X3F,
0XFC,0XF0,0X03,0X00,0X00,0XC0,0X0F,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,
0X3F,0XFC,0XF0,0X03,0X00,0X00,0XC0,0X0F,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,
0XFC,0XFF,0XFC,0XF0,0X03,0X00,0X00,0XC0,0X0F,0X00,0X00,0X00,0X00,0X00,0X00,0X00,
0X00,0XFF,0XFF,0XFC,0XF0,0X03,0X00,0X00,0XC0,0X0F,0X00,0X00,0X00,0X00,0X00,0X00,
0X00,0XC0,0XFF,0XFF,0XFF,0XFF,0X3F,0X00,0X00,0XC0,0XFF,0XFF,0XFF,0XFF,0X3F,0X00,
0X00,0X00,0XC0,0XCF,0XFF,0XFF,0XFF,0X3F,0X00,0X00,0XC0,0XFF,0XFF,0XFF,0XFF,0X3F,
0X00,0X00,0X00,0XC0,0XCF,0XCF,0XFF,0XFF,0X3F,0X00,0X00,0XC0,0XFF,0XFF,0XFF,0XFF,
0X3F,0X00,0X00,0X00,0XC0,0XCF,0X0F,0XFF,0XF0,0X03,0X00,0X00,0XC0,0XFF,0XFF,0XFF,
0XFF,0X3F,0X00,0X00,0X00,0XC0,0X0F,0X3F,0XFF,0XF0,0X03,0X00,0X00,0XC0,0X0F,0X00,
0XF0,0X03,0X00,0X00,0X00,0X00,0XC0,0X0F,0X3F,0XFC,0XF3,0X03,0X00,0X00,0XC0,0X0F,
0X00,0XF0,0X03,0X00,0X00,0X00,0X00,0XC0,0X0F,0X3F,0XFC,0XFF,0X03,0X00,0X00,0XC0,
0X0F,0X00,0XF0,0X03,0X00,0X00,0X00,0X00,0XC0,0X0F,0X3F,0XFC,0X0F,0X00,0X00,0X00,
0XC0,0X0F,0X00,0XF0,0X03,0X00,0X00,0X00,0X00,0XC0,0X0F,0XFF,0XFC,0X3F,0X00,0X00,
0X00,0XC0,0X0F,0X00,0XF0,0X03,0X00,0X00,0X00,0X00,0XC0,0XFF,0XFC,0XFC,0XFC,0X00,
0X00,0X00,0XC0,0X0F,0X00,0XF0,0X03,0X00,0X00,0X00,0X00,0XC0,0XFF,0X3C,0XFC,0XF0,
0X03,0X00,0X00,0XC0,0X0F,0X00,0XF0,0X03,0X00,0X00,0X00,0X00,0X00,0X3F,0X0C,0XFC,
0XF0,0X00,0X00,0X00,0XC0,0X0F,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,
0XFC,0XC0,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,
0X00,0XFC,0X00,0X00,0X00,0X00,0X00,0X0C,0X00,0XF0,0X00,0X00,0X00,0X00,0X00,0X00,
0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0XFF,0XF0,0XF0,0XC0,0X03,0X00,0X00,0X00,
0XC0,0X0F,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0XFF,0XF3,0XF0,0XCF,0X03,0X00,0X00,
0X00,0XC0,0X0F,0XC0,0X0F,0XC0,0X0F,0X00,0X00,0XF0,0XC3,0XF3,0XF0,0XFF,0X03,0X00,
0X00,0X00,0XC0,0X0F,0XC0,0X0F,0XC0,0X0F,0X00,0X00,0XF0,0X03,0XF0,0XF0,0XCF,0X3F,
0X00,0X00,0X00,0XC0,0X0F,0XC0,0X0F,0XC0,0X0F,0X00,0X00,0XF0,0XFF,0XFF,0XFF,0XC0,
0X3F,0X00,0X00,0X00,0XC0,0X0F,0XC0,0X0F,0XC0,0X0F,0X00,0X00,0XC0,0XFF,0XFF,0XFF,
0XC0,0X3F,0X00,0X00,0X00,0XC0,0X0F,0XC0,0X0F,0XC0,0X0F,0X00,0X00,0X00,0XC0,0XF0,
0XF0,0XFF,0X03,0X00,0X00,0X00,0XC0,0X0F,0XC0,0X0F,0XC0,0X0F,0X00,0X00,0X00,0XF0,
0XF3,0XF0,0XFF,0X03,0X00,0X00,0X00,0XC0,0X0F,0XC0,0X0F,0XC0,0X0F,0X00,0X00,0X00,
0XFC,0XF3,0XF0,0XCC,0X03,0X00,0X00,0X00,0XC0,0XFF,0XFF,0XFF,0XFF,0X0F,0X00,0X00,
0XC0,0X33,0XF0,0XF0,0XC0,0X03,0X00,0X00,0X00,0XC0,0XFF,0XFF,0XFF,0XFF,0X0F,0X00,
0X00,0XF0,0XFF,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0XC0,0XFF,0XFF,0XFF,0XFF,0X0F,
0X00,0X00,0XC0,0XFF,0XFF,0XFF,0XFF,0X03,0X00,0X00,0X00,0XC0,0X0F,0XC0,0X0F,0XC0,
0X0F,0X00,0X00,0X00,0XFC,0XFF,0XFF,0XFF,0X03,0X00,0X00,0X00,0XC0,0X0F,0XC0,0X0F,
0XC0,0X0F,0X00,0X00,0X00,0X00,0XFC,0XFF,0XFF,0X03,0X00,0X00,0X00,0XC0,0X0F,0XC0,
0X0F,0XC0,0X0F,0X00,0X00,0X00,0X00,0X00,0XFC,0XC0,0X0F,0X00,0X00,0X00,0XC0,0X0F,
0XC0,0X0F,0XC0,0X0F,0X00,0X00,0XF0,0XFF,0XFF,0XFF,0XC0,0X0F,0X00,0X00,0X00,0XC0,
0X0F,0XC0,0X0F,0XC0,0X0F,0X00,0X00,0XF0,0XFF,0XFF,0XFF,0XC0,0X0F,0X00,0X00,0X00,
0XC0,0X0F,0XC0,0X0F,0XC0,0X0F,0X00,0X00,0XF0,0XFF,0XFF,0XFF,0X00,0X3F,0X00,0X00,
0X00,0XC0,0X0F,0XC0,0X0F,0XC0,0X0F,0X00,0X00,0X00,0X00,0X00,0XFC,0X00,0X3F,0X00,
0X00,0X00,0XC0,0X0F,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0XFC,0X00,0X00,
0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,
0X00,0X00,0X00,0X00,0X00,0X00,0X00,0XFC,0X00,0X00,0X00,0X00,0XF0,0XFF,0XFF,0X00,
0X00,0X00,0X00,0X00,0X00,0XC0,0XFF,0X0F,0XFC,0XF0,0X03,0X00,0X00,0XF0,0XFF,0XFF,
0X00,0X00,0X00,0X00,0X00,0X00,0XF0,0XFF,0XFF,0XFC,0XF0,0X03,0X00,0X00,0XF0,0XFF,
0XFF,0XF0,0XFF,0X0F,0X00,0X00,0X00,0X00,0XFC,0XFF,0XFC,0XF0,0X03,0X00,0X00,0XC0,
0X0F,0XFC,0XF0,0XFF,0X0F,0X00,0X00,0X00,0X00,0X3F,0X00,0XFC,0XFF,0X3F,0X00,0X00,
0XC0,0X0F,0XFC,0XF0,0XFF,0X0F,0X00,0X00,0X00,0X00,0XFF,0XFF,0XFF,0XFF,0X3F,0X00,
0X00,0XC0,0X0F,0XFC,0XF0,0XC3,0X0F,0X00,0X00,0X00,0XC0,0XFF,0XFF,0XFF,0XFF,0X3F,
0X00,0X00,0XF0,0XFF,0XFF,0XF0,0XC3,0X0F,0X00,0X00,0X00,0XC0,0XFF,0XFF,0XFF,0XF0,
0X03,0X00,0X00,0XF0,0XFF,0XFF,0XF0,0XC3,0X0F,0X00,0X00,0X00,0XC0,0X0F,0X3F,0XFC,
0XF0,0X03,0X00,0X00,0XF0,0XFF,0XFF,0XF0,0XC3,0X0F,0X00,0X00,0X00,0XC0,0X0F,0X3F,
0XFC,0XF0,0X03,0X00,0X00,0X00,0X00,0X00,0XF0,0XC3,0X0F,0X00,0X00,0X00,0XC0,0X0F,
0X00,0X3F,0X00,0X00,0X00,0X00,0XF0,0XFF,0XFF,0XF0,0XC3,0X0F,0X00,0X00,0X00,0XC0,
0X0F,0X00,0X3F,0XC0,0X0F,0X00,0X00,0XF0,0XFF,0XFF,0XF0,0XC3,0X0F,0X00,0X00,0X00,
0XC0,0X0F,0X00,0X3F,0XC0,0X0F,0X00,0X00,0XF0,0XFF,0XFF,0XF0,0XC3,0X0F,0X00,0X00,
0X00,0XC0,0X0F,0X00,0X3F,0XC0,0X0F,0X00,0X00,0XC0,0X0F,0XFC,0XF0,0XC3,0X0F,0X00,
0X00,0X00,0XC0,0XCF,0XFF,0XFF,0XFF,0X0F,0X00,0X00,0XC0,0X0F,0XFC,0XF0,0XFF,0X0F,
0X00,0X00,0X00,0XC0,0XCF,0XFF,0XFF,0XFF,0X0F,0X00,0X00,0XC0,0X0F,0XFC,0XF0,0XFF,
0X0F,0X00,0X00,0X00,0XC0,0XCF,0XFF,0XFF,0XFF,0X0F,0X00,0X00,0XF0,0XFF,0XFF,0XF0,
0XFF,0X0F,0X00,0X00,0X00,0XC0,0X0F,0X00,0X3F,0XC0,0X0F,0X00,0X00,0XF0,0XFF,0XFF,
0X00,0X00,0X00,0X00,0X00,0X00,0XC0,0X0F,0X00,0X3F,0XC0,0X0F,0X00,0X00,0XF0,0XFF,
0XFF,0X00,0X00,0X00,0X00,0X00,0X00,0XC0,0X0F,0X00,0X3F,0XC0,0X0F,0X00,0X00,0X00,
0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X0C,0X00,0X00,0X00,0X00,0X00,0X00,
0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,
0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0XC0,0X00,0X00,0XF0,0XFF,0X0F,
0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0XF0,0XC3,0X03,0XF0,0XFF,
0X0F,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0XC0,0XCF,0XF3,0XF0,
0XFF,0X0F,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0XC0,0XCF,0XFF,
0X03,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0XFF,
0XFF,0XF3,0XFF,0X3F,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,
0XFF,0XFF,0XF3,0XFF,0X3F,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,
0XF0,0XC3,0XFF,0XFF,0XFF,0X3F,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,
0X00,0XF0,0XC3,0XFF,0XFF,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,
0X00,0X00,0XF0,0XFF,0XFC,0XFC,0X03,0X0F,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,
0X00,0X00,0X00,0XF0,0XFF,0XFC,0XFC,0XF3,0X0F,0X00,0X00,0X00,0X00,0X00,0X00,0X00,
0X00,0X00,0X00,0X00,0XC0,0XFF,0XFC,0XF0,0XFF,0X0F,0X00,0X00,0X00,0X00,0X00,0X00,
0X00,0X00,0X00,0X00,0X00,0X00,0XC0,0XF0,0XC0,0X3F,0X0F,0X00,0X00,0X00,0X00,0X00,
0X00,0X00,0X00,0X00,0X00,0X00,0X00,0XC3,0XF0,0XC3,0X0F,0X0F,0X00,0X00,0X00,0X00,
0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0XCF,0XFC,0XC3,0X0F,0X0F,0X00,0X00,0X00,
0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0XC0,0XCF,0XFF,0XC0,0X3F,0X0F,0X00,0X00,
0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0XC0,0XC3,0X0F,0XC0,0XFF,0X0F,0X00,
0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0XC0,0XC3,0X03,0XF0,0XF3,0X0F,
0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0XF0,0XF3,0X03,0XF0,0XC0,
0X0F,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0XC0,0XC0,0X00,0XF0,
0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,
0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,
0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,
0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,
0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,
0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,
0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,
0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,
0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,
0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,
0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,
0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,
0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,
0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,
0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,
0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,
0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,
0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,
0X00,0X00,0X00,0X00,0X00,
};	 
uchar code LCD_INT[74] =          //LCD的初始化指令，具体含义写在后面
	{
		0X78,0X80,	//选择地址,0X3C，加上W/R为0X78
		0X01,0X80,	//进0页
		0X09,0X80,	//选1页PPS:选页指令在0页。
		0X06,0X80,	//选择正常显示模式
		0X12,0X80,	//选择偏置模式
		0X40,0X80,	//选择前8行的显示模式？？
		0X01,0X80,	//回0页
		0X16,0X80,	//选择垂直模式，掉电模式
		0x20,0x80,	//选择Y地址，默认为0，可不设置。
		0X40,0X80,	//选择X地址，默认为0，可不设置.
		0X0C,0X80,	//翻到4页
		0X05,0X80,	//打开显示和直接驱动模式（电压倍增器）
		0X01,0X80,	//回0页
		0X0A,0X80,	//选2页
		0X08,0X80,	//设定2倍VLCD电压
		0X12,0X80,	//设定温度系数2
		0X04,0X80,	//设定VLCD为低，并关闭高压发生器
    0XC8,0X80,	//设定VLCD电压 ~=7.74V  //4.5+72*0.045
		0X01,0X80,	//回0页
		0X0B,0X80,	//翻到3页
		0X40,0X80,	//选择灰度0（寄存器）
		0X80,0X80,	//灰度0设为0
	  0X41,0X80,	//选额灰度1
		0X94,0X80,	//灰度1设为20
		0X42,0X80,	//选择灰度2
		0XA8,0X80,	//灰度2设为40
		0X43,0X80,	//选择灰度3
		0XBF,0X80,	//灰度3设为63
		0X01,0X80,	//回0页
		0X0A,0X80,	//选择2页
		0X05,0X80,	//设定VLCD为低，并打开高压发生器
		0X01,0X80,	//回0页
		0X12,0X80,	//打开操作模式，设定垂直模式 ，交换MSB和LSB 0X12:不交换MSB和LSB
		0X0A,0X80,	//翻到2页
		0X09,0X80,	//设定VLCD为3X
		0X0A,0X80,	//设定VLCD为4X
		0X0B,0X40,	//设定VLCD为5x，X040：后面开始写DDRAM显示数据
	};
	
//delay ----------------------------------------------------------------------
void delayus()
{
	uchar i=6;
	while(i--);
}

void delayms()
{
	uchar i, j;
	i = 32;
	j = 40;
	while (j--)
	{	while (i--);
	}
	}


//I2C init ----------------------------------------------------------------------
sbit I2CRST = P0^0; //定义I2C引脚
sbit SCL =P0^1;
sbit SDA = P0^2;

void I2C_SOFT_START() //软件模拟I2C 开始信号
{
	SDA = 1;
	delayus();
	SCL = 1;
	delayus();
	SDA = 0;
	delayus();
	SCL	=	0;
	SDA	= 1;
}

void I2C_SOFT_STOP() //软件模拟I2C 停止信号
{
	SDA = 0;
	delayus();
	SCL = 1;
	delayus();
	SDA = 1;
	delayus();
	SCL	=	0;
	SDA	= 1;
}


void I2C_SOFT_SEND(uchar S_SND)   //软件模拟I2C，写1字节数据
{
	uchar i,SOFT_ACK,SND;
	SOFT_ACK = 1;
while (SOFT_ACK)	
{
	SND = S_SND;
 for (i=8;i!=0;i--)
	{
		if(SND & 0X80)
			SDA = 1;
		else SDA = 0;
		SND <<=1;
		delayus();
//		delayus();
		SCL = 1;
		delayus();
//		delayus();
		SCL=0;
		delayus();
	}
		SDA =1;
		delayus();
		SCL = 1;
		if(~SDA)
		{
			delayus();  //貌似少了这个延时，有时候不能顺利初始化
			SOFT_ACK = 0; //判断是否重发
		}SCL=0;
}
}

//LCD INT ------------------------------------------------------
void LCD_INIT()
{
	uint num;
	I2CRST = 0;						//RST腿拉低
	delayms();
	I2CRST = 1;
  delayms();
	delayms();
	delayms();
	delayms();
	I2C_SOFT_START();			//发送开始信号
		for(num=0;num<=74;num++)
		{
			I2C_SOFT_SEND(LCD_INT[num]);

		}										
	}

void LCD_TEST1()        //连续写屏
{
	uint num;
			for(num=0;num<=1717;num++)
		{
			I2C_SOFT_SEND(LCD_DATA[num]);

		}	
	}


void LCD_SET_XY(uchar x,y)  //设定在X,Y位置写数据
{


I2C_SOFT_STOP();				//芯片没有返回指令列表的指令，SO，结束I2C，再打开。
	delayus();
I2C_SOFT_START();	

I2C_SOFT_SEND(0X78);	//选地址
I2C_SOFT_SEND(0X80);	//这个蛋疼的芯片，每次写一条指令都要说明下一条是指令还是数据，所以这么多0X80。
I2C_SOFT_SEND(0X01);	//选页指令
I2C_SOFT_SEND(0X80);	
I2C_SOFT_SEND(0X040|y);	//设置Y地址，（0-16）
I2C_SOFT_SEND(0X80);		
I2C_SOFT_SEND(0X80|x);	//设置X地址，	（0-100）
I2C_SOFT_SEND(0X40);		//0x40表示后面开始写数据
}

void WriteCHN16x20(uchar x,y,d)
 {
 	uchar n, xx,yy,sd;

	xx=x;
	yy=y;
	sd=d;
	
	 LCD_SET_XY( xx,yy);
 	for(n=0;n<20;n++)
		{


		
		I2C_SOFT_SEND(LCD_DISPLAY_CHN[sd]);
	
		sd=sd+1;
		}
	LCD_SET_XY( xx++,yy+1);	
	for(n=20;n<40;n++)
	{
		sd=20;
		
		I2C_SOFT_SEND(LCD_DISPLAY_CHN[sd]);
	
			sd=sd+1;
	}
 }	  

void main()
{
uchar n;
P0M0=0;
P0M1=0;
LCD_INIT();		//LCD初始化

//WriteCHN16x20( 0,0,0);
//WriteCHN16x20( 30,0,40);
//WriteCHN16x20( 60,0,80);
//WriteCHN16x20( 90,0,120);
//WriteCHN16x20( 0,5,160);
//WriteCHN16x20( 60,5,180);

LCD_TEST1();	//连续写数据测试下
/*LCD_SET_XY(60,4);	//设定从XY位置开始更新数据。
	for(n=100;n>0;n--)		//我还不会用字库，先在这个位置写几个黑点测试下。
	{
		I2C_SOFT_SEND(0XFF);
	}	*/
	
	
	while(1);		
}