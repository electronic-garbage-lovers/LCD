C51 COMPILER V7.06   TEST                                                                  11/14/2018 14:44:08 PAGE 1   


C51 COMPILER V7.06, COMPILATION OF MODULE TEST
OBJECT MODULE PLACED IN test.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE test.c OPTIMIZE(9,SPEED) BROWSE DEBUG OBJECTEXTEND

stmt level    source

   1          /* 
   2          
   3          
   4          */
   5          #include <reg52.H>
   6          #include <intrins.h>
   7          
   8          #define uchar unsigned char
   9          #define uint unsigned int
  10          
  11          
  12          sbit lcd_rs=P1^1; 
  13          sbit lcd_en=P1^2;
  14          sbit lcd_wr=P1^3; 
  15          sbit lcd_reset=P1^4;
  16          sbit lcd_cs1=P1^0; 
  17          
  18          #define DataPort P0   //DataBUS
  19          
  20          
  21          /*ÑÓÊ±£º1 ºÁÃëµÄi ±¶*/
  22          void delay(int i)
  23          {
  24   1      int j,k;
  25   1      for(j=0;j<i;j++)
  26   1      for(k=0;k<510;k++);
  27   1      }
  28          /*ÑÓÊ±£º1us µÄi ±¶*/
  29          void delay_us(int i)
  30          {
  31   1      int j,k;
  32   1      for(j=0;j<i;j++)
  33   1      for(k=0;k<10;k++);
  34   1      }
  35          
  36          //²¢¿Ú·½Ê½
  37          //Ð´Ö¸Áîµ½LCD Ä£¿é
  38          void transfer_command_lcd(int data1)
  39          {
  40   1      lcd_rs=0;
  41   1      lcd_en=1;
  42   1      P0=data1;P0=data1;P0=data1;P0=data1;
  43   1      lcd_en=0;
  44   1      }
  45          
  46          //Ð´Êý¾Ýµ½LCD Ä£¿é
  47          void transfer_data_lcd(int data1)
  48          {
  49   1      lcd_rs=1;
  50   1      lcd_en=1;
  51   1      P0=data1;P0=data1;P0=data1;P0=data1;
  52   1      lcd_en=0;
  53   1      }
  54          
  55          
C51 COMPILER V7.06   TEST                                                                  11/14/2018 14:44:08 PAGE 2   

  56          void initial_lcd()
  57          {
  58   1      lcd_wr=0; 
  59   1      lcd_cs1=0;  
  60   1      lcd_reset=0; 
  61   1      delay(150);
  62   1      lcd_reset=1;
  63   1      delay(150);
  64   1      
  65   1       
  66   1      transfer_command_lcd(0x30); //EXT=0 
  67   1      transfer_command_lcd(0x94); //Sleep out 
  68   1      transfer_command_lcd(0x31); //EXT=1 
  69   1      transfer_command_lcd(0xD7); //Autoread disable 
  70   1      transfer_data_lcd(0X9F); // 
  71   1      transfer_command_lcd(0x32); //Analog SET 
  72   1      transfer_data_lcd(0x00); //OSC Frequency adjustment 
  73   1      transfer_data_lcd(0x01); //Frequency on booster capacitors->6KHz 
  74   1      transfer_data_lcd(0x03); //Bias=1/13 
  75   1      transfer_command_lcd(0x20); //»Ò¶ÈÉèÖÃ 
  76   1      transfer_data_lcd(0x01); 
  77   1      transfer_data_lcd(0x03); 
  78   1      transfer_data_lcd(0x05); 
  79   1      transfer_data_lcd(0x07); 
  80   1      transfer_data_lcd(0x09); 
  81   1      transfer_data_lcd(0x0b); 
  82   1      transfer_data_lcd(0x0d); 
  83   1      transfer_data_lcd(0x10); 
  84   1      transfer_data_lcd(0x11); 
  85   1      transfer_data_lcd(0x13); 
  86   1      transfer_data_lcd(0x15); 
  87   1      transfer_data_lcd(0x17); 
  88   1      transfer_data_lcd(0x19); 
  89   1      transfer_data_lcd(0x1b); 
  90   1      transfer_data_lcd(0x1d); 
  91   1      transfer_data_lcd(0x1f); 
  92   1      transfer_command_lcd(0x30); //EXT1=0£¬EXT0=0,±íÊ¾Ñ¡ÔñÁË¡°À©Õ¹Ö¸Áî±í 1¡± 
  93   1      transfer_command_lcd(0x75); //Ò³µØÖ·ÉèÖÃ 
  94   1      transfer_data_lcd(0X00); //ÆðÊ¼Ò³µØÖ·£ºYS=0X00 
  95   1      transfer_data_lcd(0X14); //½áÊøÒ³µØÖ·£ºYE=0x1FÃ¿ 4 ÐÐÎªÒ»Ò³£¬µÚ 0¡«3 ÐÐÎªµÚ 0 Ò³£¬µÚ 124¡«127 ÐÐÎªµÚ 31 Ò³
             -£¨31=0x1f£© 
  96   1      transfer_command_lcd(0x15); //ÁÐµØÖ·ÉèÖÃ 
  97   1      transfer_data_lcd(0X00); //ÆðÊ¼ÁÐµØÖ·£ºXS=0 
  98   1      transfer_data_lcd(0Xef); //½áÊøÁÐµØÖ·£ºXE=240£¨0xef£© 
  99   1      transfer_command_lcd(0xbc); //ÐÐÁÐÉ¨Ãè·½Ïò 
 100   1      transfer_data_lcd(0x02); //MX.MY=Normal 
 101   1      // transfer_command_lcd(0x0c); //Êý¾Ý¸ñÊ½Ñ¡Ôñ,0x0C ÊÇµÍÎ»ÔÚÇ° D0-D7,0x08 ÊÇ¸ßÎ»ÔÚÇ° D7-D0 
 102   1      transfer_command_lcd(0xCA); //ÏÔÊ¾¿ØÖÆ 
 103   1      transfer_data_lcd(0X00); //ÉèÖÃ CL Çý¶¯ÆµÂÊ£ºCLD=0 
 104   1      transfer_data_lcd(0X9F); //Õ¼¿Õ±È£ºDuty=160 
 105   1      transfer_data_lcd(0X20); //N ÐÐ·´ÏÔ£ºNline=off 
 106   1      transfer_command_lcd(0xF0); //ÏÔÊ¾Ä£Ê½ 
 107   1      transfer_data_lcd(159); //Èç¹ûÉèÎª 0x11£º±íÊ¾Ñ¡Ôñ 4 »Ò¶È¼¶Ä£Ê½£¬Èç¹ûÉèÎª 0x10:±íÊ¾Ñ¡ÔñºÚ°×Ä£Ê½ 
 108   1      transfer_command_lcd(0x81); //ÉèÖÃ¶Ô±È¶È£¬¡°0x81¡±²»¿É¸Ä¶¯£¬½ô¸ú×ÅµÄ 2 ¸öÊý¾ÝÊÇ¿É¸ÄµÄ£¬µ«¡°ÏÈÎ¢µ÷ºó´Öµ÷¡±Õ
             -â 
 109   1      transfer_data_lcd(0x80);  //Î¢µ÷¶Ô±È¶È,¿Éµ÷·¶Î§ 0x00¡«0x3f£¬¹² 64 ¼¶ 0
 110   1      transfer_data_lcd(0x03); //´Öµ÷¶Ô±È¶È,¿Éµ÷·¶Î§ 0x00¡«0x07£¬¹² 8 ¼¶ 
 111   1      transfer_command_lcd(0x20); //µçÔ´¿ØÖÆ 
 112   1      transfer_data_lcd(0x0B); //D0=regulator ; D1=follower ; D3=booste, on:1 off:0 
 113   1      delay_us(200); 
 114   1      transfer_command_lcd(0xAF); //´ò¿ªÏÔÊ¾ 
 115   1      }
C51 COMPILER V7.06   TEST                                                                  11/14/2018 14:44:08 PAGE 3   

 116          
 117          
 118          
 119          
 120          
 121          /*Ð´LCD ÐÐÁÐµØÖ·£ºX ÎªÆðÊ¼µÄÁÐµØÖ·£¬Y ÎªÆðÊ¼µÄÐÐµØÖ·£¬x_total,y_total ·Ö±ðÎªÁÐµØÖ·¼°ÐÐµØÖ·µÄÆðµãµ½ÖÕµãµÄ²î
             -Öµ */
 122          void lcd_address(int x,int y,x_total,y_total)
 123          {
 124   1      
 125   1      transfer_command_lcd(0x15); //Set Column Address
 126   1      transfer_data_lcd(x);
 127   1      transfer_data_lcd(x+x_total-1);
 128   1      
 129   1      transfer_command_lcd(0x75); //Set Page Address
 130   1      transfer_data_lcd(y);
 131   1      transfer_data_lcd(y+y_total-1);
 132   1      
 133   1      transfer_command_lcd(0x30);
 134   1      transfer_command_lcd(0x5c);
 135   1      }
 136          
 137          
 138          
 139          
 140          void clear_screen(unsigned char c) 
 141          { 
 142   1      int i,j; 
 143   1      lcd_address(0,0,241,21); 
 144   1      for(i=0;i<160;i++) 
 145   1      { 
 146   2      for(j=0;j<256;j++) 
 147   2      { 
 148   3      transfer_data_lcd(c); 
 149   3      } 
 150   2      } 
 151   1      }
 152          
 153          
 154          
 155          
 156          
 157          
 158          
 159          void test() 
 160          { 
 161   1      unsigned int x;
 162   1      unsigned int y;
 163   1      unsigned int ca;
 164   1      unsigned int color;
 165   1      lcd_address(0,0,241,21); 
 166   1      
 167   1      for(x=0;x<110;x++)       
 168   1      {
 169   2      transfer_data_lcd(0x00); 
 170   2      }
 171   1      
 172   1      for(y=0;y<161;y++)  
 173   1      {
 174   2      for(x=0;x<80;x++)  
 175   2      {
 176   3      ca++;
C51 COMPILER V7.06   TEST                                                                  11/14/2018 14:44:08 PAGE 4   

 177   3      ca%=32;
 178   3      color=(ca<<11)+(ca<<6) +ca ;
 179   3      transfer_data_lcd(color>>8); 
 180   3      transfer_data_lcd(color); 
 181   3      }
 182   2      ca=0;
 183   2      for(x=0;x<96;x++) 
 184   2      {
 185   3      transfer_data_lcd(0x00); 
 186   3      }
 187   2      }
 188   1      }
 189          
 190          
 191          void main()
 192          {
 193   1      initial_lcd();
 194   1      clear_screen(0xFF);
 195   1      while(1)
 196   1      {
 197   2      test();
 198   2      delay(1000);
 199   2      clear_screen(0xFF); 
 200   2      delay(1000);
 201   2      clear_screen(0x00);
 202   2      delay(1000);
 203   2      }
 204   1      }
 205          
 206          
 207          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    651    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----      10
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
